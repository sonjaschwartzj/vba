<!DOCTYPE html>
<html >
<head>
  <!-- Site made with Mobirise Website Builder v4.8.2, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v4.8.2, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/logo4.png" type="image/x-icon">
  <meta name="description" content="Website Creator Description">
  <title>Datei Eintragen und in Neue Übernehmen</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  
  
  
</head>
<body>
  <section class="header1 cid-r4yFXOcQ2x mbr-parallax-background" id="header1-e">

    

    

    <div class="container">
        <div class="row justify-content-md-center">
            <div class="mbr-white col-md-10">
                <h1 class="mbr-section-title align-center mbr-bold pb-3 mbr-fonts-style display-1">VBA Code<br></h1>
                <h3 class="mbr-section-subtitle align-center mbr-light pb-3 mbr-fonts-style display-2">Datei eintragen und in neue übernehmen</h3>
                <p class="mbr-text align-center pb-3 mbr-fonts-style display-5">Speichert Werte in einer Datei ab öffnet neue Datei Speichert unter Vorgegebenen Namen ab und trägt werte in die neue Datei ein</p>
                <div class="mbr-section-btn align-center"><a class="btn btn-md btn-primary display-4" href="http://index.html"><span class="mbri-github mbr-iconfont mbr-iconfont-btn"></span></a></div>
            </div>
        </div>
    </div>

</section>

<section class="engine"><a href="https://mobiri.se/c">site builder</a></section><section class="mbr-section article content1 cid-r4yFXPEsTy" id="content1-f">
    
     

    <div class="container">
        <div class="media-container-row">
            <div class="mbr-text col-12 col-md-8 mbr-fonts-style display-7"><strong>Private Sub cmdWeiter_Click()
</strong><div><strong>Dim nZeile As Long
</strong></div><div><strong>Dim Dateipfad As String, Dateiname As String
</strong></div><div><strong>
</strong></div><div><strong>
</strong></div><div><strong>
</strong></div><div><strong>nZeile = tblKunden.Cells(Rows.Count, 1).End(xlUp).Row + 1
</strong></div><div><strong>If Range("A2") = "" Then
</strong></div><div><strong>&nbsp; &nbsp; nZeile = 2
</strong></div><div><strong>Else
</strong></div><div><strong>End If
</strong></div><div><strong>
</strong></div><div><strong>'Bestellung in Übersicht eintragen
</strong></div><div><strong>Cells(nZeile, 1).Value = Application.Text(nZeile - 1, "0000")
</strong></div><div><strong>Cells(nZeile, 2).Value = txtFirma
</strong></div><div><strong>Cells(nZeile, 3).Value = txtAP
</strong></div><div><strong>Cells(nZeile, 4).Value = txtEmail
</strong></div><div><strong>Cells(nZeile, 5).Value = txtTel
</strong></div><div><strong>Cells(nZeile, 6).Value = txtStr
</strong></div><div><strong>Cells(nZeile, 7).Value = txtPLZ
</strong></div><div><strong>Cells(nZeile, 8).Value = txtOrt
</strong></div><div><strong>Cells(nZeile, 9).Value = cboBranche
</strong></div><div><strong>Cells(nZeile, 10).Value = Date
</strong></div><div><strong>Cells(nZeile, 12).Value = cboAnrede
</strong></div><div><strong>ActiveSheet.Hyperlinks.Add Anchor:=Cells(nZeile, 11), Address:=ActiveWorkbook.Path &amp; "\Kundenkonto\" &amp; Format(nZeile - 1, "0000") &amp; " - " &amp; "Kundenkonto" &amp; " - " &amp; txtFirma &amp; " - " &amp; txtPLZ &amp; ".xlsm", TextToDisplay:="Kundenkonto öffnen"
</strong></div><div><strong>
</strong></div><div><strong>
</strong></div><div><strong>'kundenkonto erzeugen
</strong></div><div><strong>Workbooks.Open Left(ActiveWorkbook.Path, InStrRev(ThisWorkbook.Path, Application.PathSeparator)) &amp; "\Kundenkonto\Kundenkontovorlage.xlsm"
</strong></div><div><strong>
</strong></div><div><strong>Sheets("Stammdaten").Activate
</strong></div><div><strong>Dateipfad = ActiveWorkbook.Path &amp; "\"
</strong></div><div><strong>Dateiname = Format(nZeile - 1, "0000") &amp; " - " &amp; "Kundenkonto" &amp; " - " &amp; txtFirma &amp; " - " &amp; txtPLZ
</strong></div><div><strong>
</strong></div><div><strong>Dateiname = Dateipfad &amp; Dateiname &amp; ".xlsm"
</strong></div><div><strong>ActiveWorkbook.SaveAs Filename:=Dateiname, FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False
</strong></div><div><strong>
</strong></div><div><strong>
</strong></div><div><strong>&nbsp; &nbsp; Range("C5").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = Format(nZeile - 1, "0000")
</strong></div><div><strong>&nbsp; &nbsp; Range("C6").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = txtFirma
</strong></div><div><strong>&nbsp; &nbsp; Range("C7").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = txtAP
</strong></div><div><strong>&nbsp; &nbsp; Range("C8").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = txtEmail
</strong></div><div><strong>&nbsp; &nbsp; Range("C9").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = txtTel
</strong></div><div><strong>&nbsp; &nbsp; Range("C10").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = txtStr
</strong></div><div><strong>&nbsp; &nbsp; Range("C11").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = txtPLZ
</strong></div><div><strong>&nbsp; &nbsp; Range("C12").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = txtOrt
</strong></div><div><strong>&nbsp; &nbsp; Range("C13").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = cboBranche
</strong></div><div><strong>&nbsp; &nbsp; Range("C14").Select
</strong></div><div><strong>&nbsp; &nbsp; ActiveCell.FormulaR1C1 = cboAnrede
</strong></div><div><strong>Unload Me
</strong></div><div><strong>Range("A3").Select
</strong></div><div><strong>
</strong></div><div><strong>MsgBox "Dieser Kunde bekommt die Nr.:" &amp; Application.Text(nZeile - 1, "0000")
</strong></div><div><strong>End Sub</strong></div></div>
        </div>
    </div>
</section>


  <script src="assets/web/assets/jquery/jquery.min.js"></script>
  <script src="assets/popper/popper.min.js"></script>
  <script src="assets/tether/tether.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/parallax/jarallax.min.js"></script>
  <script src="assets/theme/js/script.js"></script>
  
  
</body>
</html>